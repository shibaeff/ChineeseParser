# -*- coding: utf-8 -*-
import scrapy
import re
from scrapy.linkextractors import LinkExtractor
from scrapy.spiders import Rule, CrawlSpider
import pickle
from random import choice

import os
from os.path import join, dirname
from dotenv import load_dotenv
from requests import *
from bs4 import BeautifulSoup
 
dotenv_path = join(dirname(__file__), '../.env')
load_dotenv(dotenv_path)

LINKS_DIST=os.getenv('LINKS_DIST')
PROVINCE_RE = r'http:\/\/[a-z]*\.liebiao\.com\/$'
 
# Accessing variables.
INDS=['/xuelijiaoyu/', '/xuelirenzheng/', '/yuanchengjiaoyu/', '/zhuanshengben/', '/kaoyan/', '/zixuekaoshi/', '/chengrenkaoshi/', '/zaizhiyanjiusheng/', '/kaobo/', '/zaizhiboshi/', '/minbanjiaoyu/', '/diannaopeixun/', '/rjgcspx/', '/wlgcspx/', '/ciscopeixun/', '/mcsepeixun/', '/phppx/', '/javapeixun/', '/oraclepeixun/', '/wlyxpx/', '/jsjdjks/', '/dnwxpx/', '/waiyupeixun/', '/yingyupeixun/', '/riyupeixun/', '/hanyupeixun/', '/fayupeixun/', '/deyupeixun/', '/eyupeixun/', '/xibanyayupeixun/', '/putaoyayupeixun/', '/taiyupeixun/', '/xiaoyuzhong/', '/guanlipeixun/', '/mba/', '/emba/', '/xmglpx/', '/qyglpx/', '/cwpx/', '/jdpx/', '/ygpx/', '/qtmbapx/', '/xiaoshoupeixun/', '/yingyouerjiaoyu/', '/xueqianjiaoyu/', '/qinzijiaoyu/', '/zhilikaifa/', '/youertuoguan/', '/taijiao/', '/youeryuan/', '/zhiyepeixun/', '/zigepeixun/', '/gwypx/', '/ckpx/', '/rlzypx/', '/yishipx/', '/daoyoupx/', '/wenmipx/', '/bgypx/', '/sifakaoshi/', '/fanyipx/', '/zhongxiaoxuejiaoyu/', '/xiaoxuefudao/', '/xiaoshengchufudao/', '/chuzhongfudao/', '/zhongkaofudao/', '/gaokaofudao/', '/yuwenfudao/', '/shuxuefudao/', '/wulifudao/', '/huaxuefudao/', '/suzhijiaoyu/', '/shejipeixun/', '/psmsjpx/', '/snsjpx/', '/fzjcpx/', '/wysjpx/', '/jzsjpx/', '/mjsjpx/', '/qtsjpx/', '/guanggaosheji/', '/jingguansheji/', '/secaidapei/', '/caiyipeixun/', '/yinyuepeixun/', '/yqpx/', '/wudaopeixun/', '/meishupeixun/', '/qileipeixun/', '/yujiapeixun/', '/biaoyanpeixun/', '/wushupeixun/', '/taiquandaopeixun/', '/sandapeixun/', '/jiajiao/', '/xiaoxuejiajiao/', '/chuzhongjiajiao/', '/gaozhongjiajiao/', '/xscjiajiao/', '/shuxuejiajiao/', '/yuwenjiajiao/', '/yingyujiajiao/', '/meishujiajiao/', '/gangqinjiajiao/', '/daxueshengjiajiao/', '/qitapeixun/', '/liuxue/', '/meiguoliuxue/', '/jianadaliuxue/', '/ribenliuxue/', '/aozhouliuxue/', '/deguoliuxue/', '/yingguoliuxue/', '/faguoliuxue/', '/hanguoliuxue/', '/qitaliuxue/', '/xinjiapoliuxue/', '/yimin/', '/jishuyimin/', '/touziyimin/', '/meiguoyimin/', '/jianadayimin/', '/aodaliyayimin/', '/xinxilanyimin/', '/xinjiapoyimin/', '/ouzhouyimin/', 'http://m.liebiao.com/jinzhong/peixun/', '/xuelijiaoyu/', '/diannaopeixun/', '/waiyupeixun/', '/guanlipeixun/', '/yingyouerjiaoyu/', '/zhiyepeixun/', '/zhongxiaoxuejiaoyu/', '/shejipeixun/', '/caiyipeixun/', '/jiajiao/', '/qitapeixun/', '/liuxue/', '/yimin/', '/gongsizhuce/', '/gongshangnianjian/', '/gongshangdaiban/', '/xianggangzhuce/', '/haiwaigongsizhuce/', '/gongshangzhuce/', '/gongsizhuce/', '/gongshangnianjian/', '/gongshangdaiban/', '/jianweizizhi/', '/wuyezizhi/', '/qiyebiangeng/', '/qiyenianjian/', '/xianggangzhuce/', '/haiwaigongsizhuce/', '/shuiwudengji/', '/dailijizhang/', '/suiwuzixun/', '/caiwushenji/', '/caisuiyinan/', '/gongchengzaojia/', '/kuaijishenji/', '/shuiwudengji/', '/dailijizhang/', '/yanzidaili/', '/pinggufuwu/', '/caiwushenji/', '/zichanpinggu/', '/suiwuzixun/', '/gongchengzaojia/', '/caisuiyinan/', '/nashuishenbao/', '/chugu/', '/weiyujiej/', '/yimenbigui/', '/tuliaobizhi/', '/longtoushuicao/', '/jiancai/', '/chugu/', '/weiyujiej/', '/yimenbigui/', '/tuliaobizhi/', '/longtoushuicao/', '/liangyijia/', '/nuanqidinuan/', '/zhinengjiajuxitong/', '/huanba/', '/tongchengkuaidi/', '/guoneikuaidi/', '/guojikuaidi/', '/huowukuaidi/', '/kuaidi/', '/tongchengkuaidi/', '/guoneikuaidi/', '/guojikuaidi/', '/huowukuaidi/', '/dayinjiweixiu/', '/fuyinjiweixiu/', '/chuanzhenjiweixiu/', '/yinshuajiweixiu/', '/bangongshebeiweixiu/', '/dayinjiweixiu/', '/fuyinjiweixiu/', '/chuanzhenjiweixiu/', '/yinshuajiweixiu/', '/penmajiweixiu/', '/jituandianhua/', '/touyingyiweixiu/', '/huituyiweixiu/', '/kaoqinjiweixiu/', '/saomiaoyiweixiu/', '/anfangxitongweixiu/', '/suizhijiweixiu/', '/jiankongmenjinweixiu/', '/ledweixiu/', '/kuaijishenji/', '/gongshangzhuce/','http://post.liebiao.com/publish/city-2505/bigcate-11', '/baomu/', '/yuesao/', '/jiadianweixiu/', '/kaisuo/', '/banjia/', '/guandao/', '/jiazheng/', '/zhongdiangong/', '/shewaijiazheng/', '/feiyong/', '/cuirushi/', '/yuezizhongxin/', '/chanhouhuifu/', '/tuoguansuo/', '/baomu/', '/yuesao/', '/muyinghuli/', '/yuersao/', '/yuyingshi/', '/yiliaopeihu/', '/hugong/', '/muyingqinzi/', '/lajiqingyun/', '/jianzuweixiu/', '/guandao/', '/xiashudaoshutong/', '/matongshutong/', '/huafenchiqingli/', '/guandaoanzhuang/', '/dalao/', '/shizhengguandaoqingyu/', '/geyouchiqingli/', '/guandaojiance/', '/gaoyaqingxi/', '/meiqitianrangqiguandao/', '/baojie/', '/richangbaojie/', '/youyanjiqingxi/', '/waiqiangqingxi/', '/dibandala/', '/shicaifanxin/', '/shuijingdengqingxi/', '/shachong/', '/bizhiqingxi/', '/kongqijinghua/', '/jiaquanjiance/', '/kongqijiance/', '/jiatingbaojie/', '/gaokongqingxi/', '/dinuanqingxi/', '/cizhuanmeifeng/', '/bingxiangqingxi/', '/xiyijiqingxi/', '/yinshuijiqingxi/', '/reshuiqiqingxi/', '/kaihuangbaojie/', '/baojieyuan/', '/qingjiegongsi/', '/kongtiaoqingxi/', '/ditanqingxi/', '/shafaqingxi/', '/banjia/', '/juminbanjia/', '/gongsibanjia/', '/banchang/', '/shebeibanqian/', '/jiajuchaizhuang/', '/changtubanjia/', '/qizhongdiaozhuang/', '/gangqinbanyun/', '/guojibanjia/', '/fangwuweixiu/', '/weiyuweixiu/', '/zhongbiaoweixiu/', '/dengjuweixiu/', '/zhuoyiguiweixiu/', '/dibanweixiu/', '/qiqiangchaichu/', '/shafahuli/', '/menchuangweixiu/', '/shuidiananzhuang/', '/dianluweixiu/', '/fangshui/', '/dinuan/', '/dakong/', '/fenshua/', '/jiadianweixiu/', '/bingxiangweixiu/', '/youyanjiweixiu/', '/dianciluweixiu/', '/weiboluweixiu/', '/dianfanguoweixiu/', '/yinxiangweixiu/', '/bianpinqiweixiu/', '/jingshuiqiweixiu/', '/kafeijiweixiu/', '/xiaojiadianweixiu/', '/kongtiaoyiji/', '/dianshijiweixiu/', '/xichenqiweixiu/', '/kongtiaoweixiu/', '/kongtiaojiafu/', '/ranqizaoweixiu/', '/xiyijiweixiu/', '/reshuiqiweixiu/', '/diannaoweixiu/', '/bijibenweixiu/', '/taishijiweixiu/', '/shujuhuifu/', '/fuwuqiweixiu/', '/pingbandiannaoweixiu/', '/wangluoweixiu/', '/peisong/', '/songshui/', '/yiyuanguahao/', '/jichangpeisong/', '/meitan/', '/liangyoufushiwu/', '/songbingkuai/', '/songsuannai/', '/songqi/', '/paotui/', '/shucaipeisong/', '/xianhuasudi/', '/lingshiyanjiupeisong/', '/kuaicanpeisong/', '/daipaidui/', '/paifachuandan/', '/jiuhuo/', '/jinshuhuishou/', '/shechipinhuishou/', '/jinyinhuishou/', '/jianzhufeiliaohs/', '/kucunjiya/', '/dianchihuishou/', '/suliaohuishou/', '/bolihuishou/', '/feizhihuishou/', '/fangzhipigehs/', '/feixiangjiaohs/', '/dianqihuishou/', '/fuzhuangyimaohs/', '/shoujihs/', '/xiaofeiquanhuishou/', '/yanjiuhuishou/', '/gouwukahuishou/', '/yishupinhuishou/', '/diannaohuishou/', '/dianzihuishou/', '/jiajuhuishou/', '/bangongshebeihuishou/', '/shebeihuishou/', '/yaopinhuishou/', '/lipinhuishou/', '/shumaweixiu/', '/shumaxiangjiweixiu/', '/shumashexiangjiweixiu/', '/duijiangjiweixiu/', '/youxijiweixiu/', '/luyinshebe/', '/shumaxiangkuan/', '/daohangyiweixiu/', '/shoujishumaweixiu/', '/iphoneweixiu/', '/sanxingweixiu/', '/huaweiweixiu/', '/xiaomiweixiu/', '/meizuweixiu/', '/vivoweixiu/', '/oppoweixiu/', '/nubiyaweixiu/', '/chuiziweixiu/', '/leshiweixiu/', '/yijiaweixiu/', '/nuojiyaweixiu/', '/motuoluolaweixiu/', '/suoniweixiu/', '/xiapuweixiu/', '/lgweixiu/', '/duopudaweixiu/', '/lianxiangweixiu/', '/htcweixiu/', '/heimeiweixiu/', '/zhongxingweixiu/', '/kupaiweixiu/', '/tianyuweixiu/', '/jinliweixiu/', '/qitaweixiu/', '/shineishejifuwu/', '/jiatingzhuangxiu/', '/xianhualvzhi/', '/jiaquanjiance/', '/zhuangxiu/', '/jiudianzhuangxiu/', '/bangongshizhuangxiu/', '/changfangzhuangxiu/', '/dianmianzhuangxiu/', '/bieshuzhuangxiu/', '/fangwugaizao/', '/fanchuchangguan/', '/ggcszx/', '/cantingzhuangxiu/', '/ylcszhuangxiu/', '/yeyzhuangxiu/', '/yiyuanzhuangxiu/', '/zijianfang/', '/spcszhuangxiu/', '/zhantingzhuangxiu/', '/huodongfangdingzhi/', '/xiaofangsheji/', '/xiaofangzizhibanli/', '/xianhualvzhi/', '/xianhua/', '/ganhuajiahua/', '/lvzhi/', '/yuanlinyuanyi/', '/yuanyi/', '/jiashanshi/', '/chengshilvhua/', '/qitashenghuo/', '/hunqing/', '/hunlicehua/', '/zhuchisiyi/', '/hunshasheying/', '/ertongsheying/', '/hunqingyili/', '/hunqing/', '/hunlicehua/', '/hunliyongpin/', '/hunyanjiudian/', '/hunshalifu/', '/huazhuangzaoxing/', '/zhuchisiyi/', '/genpaishelu/', '/dengguangyinxiang/', '/hunchezulin/', '/shebeizulin/', '/qingdiangongsi/', '/yueduiyanchu/', '/liyimote/', '/changdibuzhi/', '/zhanlanzhanhui/', '/sheying/', '/hunshasheying/', '/ertongsheying/', '/gerenxiezhen/', '/yishusheying/', '/shangyesheying/', '/shexiang/', '/chongyin/', '/xiangkuangzhizuo/', '/xuanchuanpianpaishezhizuo/', '/guanggaopianpaishezhizuo/', '/dujiacun/', '/lvyou/', '/jiudianyuding/', '/huwai/', '/yundongjianshen/', '/dujiayou/', '/nongjiale/', '/caizhai/', '/dujiacun/', '/wenquandujiacun/', '/shaokaoyuan/', '/shengtaiyuan/', '/jiudianyuding/', '/rizuduanzu/', '/liansuojiudian/', '/kezhanyuding/', '/qingnianlvshe/', '/jjxjd/', '/jiudian/', '/bieshu/', '/huiyijiudian/', '/minsu/', '/wenquanjiudian/', '/huwai/', '/huaxuechang/', '/liubingchang/', '/panyan/', '/qima/', '/kadingche/', '/bengji/', '/piaoliu/', '/tuozhanxunlian/', '/yezhanjulebu/', '/zhenrencs/', '/qianshui/', '/huaxiangsan/', '/yundongjianshen/', '/jianshenzhongxin/', '/tiyuguan/', '/yujiaguan/', '/youyongguan/', '/taiquandaoguan/', '/wushuguan/', '/yumaoqiuguan/', '/pingpangqiuguan/', '/baolingqiuguan/', '/wangqiuguan/', '/lanqiuchang/', '/zuqiuchang/', '/gaoerfuqiuchang/', '/lvyou/', '/guoneiyou/', '/zhoubianyou/', '/haiwaiyou/', '/gangaotai/', '/canyin/', '/kuaicanwaimai/', '/chuancai/', '/xiangcai/', '/yuecai/', '/dongbeicai/', '/lucai/', '/beijingcai/', '/shanghaicai/', '/huaiyangcai/', '/zhejiangcai/', '/hubeicai/', '/meishicanyin/', '/guizhoucai/', '/yunnancai/', '/minnancai/', '/huicai/', '/henancai/', '/xibeicai/', '/shanxicai/', '/taiwancai/', '/hanguoliaoli/', '/ribenliaoli/', '/tuantican/', '/sushi/', '/zihzucan/', '/dongnanyacai/', '/xiangguokaoyu/', '/qitacaise/', '/waimai/', '/huoguocanyin/', '/xicancanyin/', '/shaokao/', '/mianbaotiandian/', '/xiaochi/', '/haixiancanyin/', '/xiuxianyule/', '/jiubaditing/', '/ktvtaiqiuting/', '/dianyingyuan/', '/chaguan/', '/kafeiting/', '/zuliaoanmo/', '/wenquanxiyuyule/', '/meirongmeifafuwu/', '/zuoyouqipai/', '/shougongfang/', '/hongpaguan/', '/mishitaotuo/', '/meirong/', '/yiliao/', '/yiliao/', '/meirong/', '/zhengxing/', '/jianfeiba/', '/longxiong/', '/fengxiong/', '/shoushen/', '/shoulian/', '/longbi/', '/qudou/', '/tuomao/', '/chuzhouwen/', '/shuangyanpi/', '/zhifa/', '/wenshen/', '/chubahen/', '/quyandai/', '/meijia/', '/zhongyaoquban/', '/zhenjiujianfei/', '/maixianjianfei/', '/xizhijianfei/', '/mianbuxizhi/', '/jiazheng/', '/yiliao/', '/hunqingyili/', '/zhuangxiu/', '/jiuhuo/', '/kaisuo/', '/jiadianweixiu/', '/guandao/', '/banjia/', '/baojie/', '/jiazheng/', '/jiadianweixiu/', '/kaisuo/', '/banjia/394718540.html', '/banjia/504886730.html', '/banjia/507494303.html', '/banjia/507494270.html', '/banjia/507494187.html', '/banjia/507494158.html', '/jiazheng/513782877.html', '/jiazheng/513616869.html', '/jiazheng/478619584.html', '/jiazheng/512189701.html', '/jiazheng/512061454.html', '/jiazheng/511923342.html', '/jiadianweixiu/512913647.html', '/jiadianweixiu/513570917.html', '/jiadianweixiu/513570879.html', '/jiadianweixiu/513570798.html', '/jiadianweixiu/513570728.html', '/jiadianweixiu/513423162.html', '/baojie/400269658.html', '/baojie/320304618.html', '/baojie/515113146.html', '/baojie/513784784.html', '/baojie/513578281.html', '/baojie/513427090.html', '/kaisuo/504901610.html', '/kaisuo/495568582.html', '/kaisuo/428413279.html', '/kaisuo/316486686.html', '/kaisuo/517522351.html', '/kaisuo/516111400.html', '/hunqing/', '/hunlicehua/', '/hunshasheying/', '/zhuchisiyi/', '/ertongsheying/', '/hunlicehua/426800411.html', '/hunlicehua/384893174.html', '/hunlicehua/354538313.html', '/hunlicehua/394213352.html', '/hunlicehua/452601064.html', '/hunlicehua/441335699.html', '/hunshasheying/511019383.html', '/hunshasheying/452595563.html', '/hunshasheying/445102896.html', '/hunshasheying/418925366.html', '/hunshasheying/417658501.html', '/hunshasheying/417658516.html', '/ertongsheying/511019383.html', '/ertongsheying/452595563.html', '/ertongsheying/444961911.html', '/ertongsheying/350479582.html', '/ertongsheying/354740339.html', '/ertongsheying/319574046.html', '/hunqing/519435899.html', '/hunqing/484475988.html', '/hunqing/426800411.html', '/hunqing/70721289.html', '/hunqing/514760650.html', '/hunqing/514466706.html', '/zhuchisiyi/519435899.html', '/zhuchisiyi/484475988.html', '/zhuchisiyi/514760650.html', '/zhuchisiyi/514466706.html', '/zhuchisiyi/514457934.html', '/zhuchisiyi/512898652.html', '/jiatingzhuangxiu/', '/jiazhuangsheji/', '/bangongshizhuangxiu/', '/dianmianzhuangxiu/', '/fangwugaizao/', '/jiatingzhuangxiu/440258546.html', '/jiatingzhuangxiu/440258608.html', '/jiatingzhuangxiu/440259003.html', '/jiatingzhuangxiu/440259178.html', '/jiatingzhuangxiu/440259194.html', '/jiatingzhuangxiu/440259216.html', '/jiazhuangsheji/440258546.html', '/jiazhuangsheji/440258608.html', '/jiazhuangsheji/440259003.html', '/jiazhuangsheji/440259178.html', '/jiazhuangsheji/440259194.html', '/jiazhuangsheji/440259216.html', '/bangongshizhuangxiu/516168943.html', '/bangongshizhuangxiu/379371456.html', '/bangongshizhuangxiu/379376383.html', '/bangongshizhuangxiu/379379035.html', '/bangongshizhuangxiu/379444744.html', '/canyin/', '/jiudianyuding/', '/lvyou/', '/yundongjianshen/', '/nongjiale/', '/canyin/373563026.html', '/canyin/517803825.html', '/canyin/510551509.html', '/canyin/508229264.html', '/canyin/505301714.html', '/canyin/501201457.html', '/yundongjianshen/324183723.html', '/yundongjianshen/290119262.html', '/yundongjianshen/335094984.html', '/yundongjianshen/333219858.html', '/yundongjianshen/491829141.html', '/yundongjianshen/327501001.html', '/lvyou/437399735.html', '/lvyou/461256903.html', '/lvyou/458444015.html', '/lvyou/458015805.html', '/lvyou/442819391.html', '/lvyou/443896342.html', '/jiudianyuding/148406425.html', '/jiudianyuding/437351830.html', '/jiudianyuding/394212503.html', '/jiudianyuding/335663574.html', '/jiudianyuding/335663581.html', '/jiudianyuding/302994281.html', '/dujiayou/310744139.html', '/dujiayou/317898427.html', '/dujiayou/302242307.html', '/dujiayou/215199180.html', '/dujiayou/197560911.html', '/dujiayou/189272360.html', '/jiazheng/', '/zhongdiangong/', '/baomu/', '/yuesao/', '/muyinghuli/', '/yuersao/', '/yuyingshi/', '/yiliaopeihu/', '/hugong/', '/shewaijiazheng/', '/feiyong/', '/cuirushi/', '/yuezizhongxin/', '/chanhouhuifu/', '/tuoguansuo/', '/guangjia/', '/xiaoertuina/', '/baojie/', '/richangbaojie/', '/jiatingbaojie/', '/kaihuangbaojie/', '/baojieyuan/', '/qingjiegongsi/', '/kongtiaoqingxi/', '/ditanqingxi/', '/shafaqingxi/', '/youyanjiqingxi/', '/waiqiangqingxi/', '/dibandala/', '/shicaifanxin/', '/shuijingdengqingxi/', '/shachong/', '/bizhiqingxi/', '/kongqijinghua/', '/jiaquanjiance/', '/kongqijiance/', '/gaokongqingxi/', '/dinuanqingxi/', '/cizhuanmeifeng/', '/bingxiangqingxi/', '/xiyijiqingxi/', '/yinshuijiqingxi/', '/reshuiqiqingxi/', '/banjia/', '/juminbanjia/', '/gongsibanjia/', '/banchang/', '/shebeibanqian/', '/jiajuchaizhuang/', '/changtubanjia/', '/qizhongdiaozhuang/', '/gangqinbanyun/', '/guojibanjia/', '/peisong/', '/songshui/', '/songqi/', '/paotui/', '/shucaipeisong/', '/xianhuasudi/', '/lingshiyanjiupeisong/', '/kuaicanpeisong/', '/daipaidui/', '/paifachuandan/', '/yiyuanguahao/', '/jichangpeisong/', '/meitan/', '/liangyoufushiwu/', '/songbingkuai/', '/songsuannai/', '/jiadianweixiu/', '/bingxiangweixiu/', '/dianshijiweixiu/', '/xichenqiweixiu/', '/kongtiaoweixiu/', '/kongtiaojiafu/', '/ranqizaoweixiu/', '/xiyijiweixiu/', '/reshuiqiweixiu/', '/youyanjiweixiu/', '/dianciluweixiu/', '/weiboluweixiu/', '/dianfanguoweixiu/', '/yinxiangweixiu/', '/bianpinqiweixiu/', '/jingshuiqiweixiu/', '/kafeijiweixiu/', '/xiaojiadianweixiu/', '/kongtiaoyiji/', '/diannuanluweixiu/', '/pobijiweixiu/', '/lengkuanzhuangweixiu/', '/diannaoweixiu/', '/bijibenweixiu/', '/taishijiweixiu/', '/shujuhuifu/', '/fuwuqiweixiu/', '/pingbandiannaoweixiu/', '/wangluoweixiu/', '/diannaogaizhuang/', '/shumaweixiu/', '/shumaxiangjiweixiu/', '/shumashexiangjiweixiu/', '/duijiangjiweixiu/', '/youxijiweixiu/', '/luyinshebe/', '/shumaxiangkuan/', '/daohangyiweixiu/', '/jiajuweixiu/', '/shafahuli/', '/zhongbiaoweixiu/', '/zhuoyiguiweixiu/', '/dibanweixiu/', '/kaisuo/', '/zhuangxiu/', '/jiudianzhuangxiu/', '/bangongshizhuangxiu/', '/changfangzhuangxiu/', '/dianmianzhuangxiu/', '/bieshuzhuangxiu/', '/fangwugaizao/', '/fanchuchangguan/', '/ggcszx/', '/cantingzhuangxiu/', '/ylcszhuangxiu/', '/yeyzhuangxiu/', '/yiyuanzhuangxiu/', '/zijianfang/', '/spcszhuangxiu/', '/zhantingzhuangxiu/', '/huodongfangdingzhi/', '/xiaofangsheji/', '/xiaofangzizhibanli/', '/guandao/', '/xiashudaoshutong/', '/matongshutong/', '/huafenchiqingli/', '/guandaoanzhuang/', '/dalao/', '/shizhengguandaoqingyu/', '/geyouchiqingli/', '/guandaojiance/', '/gaoyaqingxi/', '/meiqitianrangqiguandao/', '/lvyou/', '/guoneiyou/', '/zhoubianyou/', '/haiwaiyou/', '/gangaotai/', '/dujiayou/', '/nongjiale/', '/caizhai/', '/dujiacun/', '/wenquandujiacun/', '/shaokaoyuan/', '/shengtaiyuan/', '/jiudianyuding/', '/rizuduanzu/', '/liansuojiudian/', '/kezhanyuding/', '/qingnianlvshe/', '/jjxjd/', '/jiudian/', '/bieshu/', '/huiyijiudian/', '/minsu/', '/wenquanjiudian/', '/canyin/', '/kuaicanwaimai/', '/waimai/', '/meishicanyin/', '/tuantican/', '/huoguocanyin/', '/xicancanyin/', '/shaokao/', '/mianbaotiandian/', '/xiaochi/', '/haixiancanyin/', '/chuancai/', '/xiangcai/', '/yuecai/', '/dongbeicai/', '/lucai/', '/beijingcai/', '/shanghaicai/', '/huaiyangcai/', '/zhejiangcai/', '/hubeicai/', '/guizhoucai/', '/yunnancai/', '/minnancai/', '/huicai/', '/henancai/', '/xibeicai/', '/shanxicai/', '/taiwancai/', '/hanguoliaoli/', '/ribenliaoli/', '/sushi/', '/zihzucan/', '/dongnanyacai/', '/xiangguokaoyu/', '/qitacaise/', '/yundongjianshen/', '/jianshenzhongxin/', '/tiyuguan/', '/yujiaguan/', '/youyongguan/', '/taiquandaoguan/', '/wushuguan/', '/yumaoqiuguan/', '/pingpangqiuguan/', '/baolingqiuguan/', '/wangqiuguan/', '/lanqiuchang/', '/zuqiuchang/', '/gaoerfuqiuchang/', '/xiuxianyule/', '/jiubaditing/', '/ktvtaiqiuting/', '/dianyingyuan/', '/chaguan/', '/kafeiting/', '/zuliaoanmo/', '/wenquanxiyuyule/', '/meirongmeifafuwu/', '/zuoyouqipai/', '/shougongfang/', '/hongpaguan/', '/mishitaotuo/', '/huwai/', '/huaxuechang/', '/liubingchang/', '/panyan/', '/qima/', '/kadingche/', '/bengji/', '/piaoliu/', '/tuozhanxunlian/', '/yezhanjulebu/', '/zhenrencs/', '/qianshui/', '/huaxiangsan/', '/yiliao/', '/fuke/', '/nanke/', '/zhongyiyuan/', '/ganbingyiyuan/', '/fuyoubaojian/', '/yankeyiyuan/', '/zhongliuyiyuan/', '/buyunbuyu/', '/kouqiangyiyuan/', '/tijianzhongxin/', '/zhensuo/', '/pifuke/', '/jingshenxinli/', '/yiliaoqixie/', '/yaopin/', '/guke/', '/meirong/', '/zhengxing/', '/jianfeiba/', '/longxiong/', '/fengxiong/', '/shoushen/', '/shoulian/', '/longbi/', '/qudou/', '/tuomao/', '/chuzhouwen/', '/shuangyanpi/', '/zhifa/', '/wenshen/', '/chubahen/', '/quyandai/', '/meijia/', '/zhongyaoquban/', '/zhenjiujianfei/', '/maixianjianfei/', '/xizhijianfei/', '/mianbuxizhi/', '/hunqingyili/', '/hunqing/', '/hunlicehua/', '/hunliyongpin/', '/hunyanjiudian/', '/hunshalifu/', '/huazhuangzaoxing/', '/zhuchisiyi/', '/genpaishelu/', '/dengguangyinxiang/', '/hunchezulin/', '/shebeizulin/', '/qingdiangongsi/', '/yueduiyanchu/', '/liyimote/', '/changdibuzhi/', '/zhanlanzhanhui/', '/xianhualvzhi/', '/xianhua/', '/ganhuajiahua/', '/lvzhi/', '/yuanlinyuanyi/', '/yuanyi/', '/jiashanshi/', '/chengshilvhua/', '/sheying/', '/hunshasheying/', '/ertongsheying/', '/gerenxiezhen/', '/yishusheying/', '/shangyesheying/', '/shexiang/', '/chongyin/', '/xiangkuangzhizuo/', '/xuanchuanpianpaishezhizuo/', '/guanggaopianpaishezhizuo/', '/yanglaoyuan/', '/ganxi/', '/ganxidian/', '/gaiyi/', '/xiuxie/', '/pijuhuli/', '/xiangbaogaizhi/', '/jiajuyongpinqingxiyanghu/', '/qichezuoyiqingxiyanghu/', '/jiuhuo/', '/jinshuhuishou/', '/dianqihuishou/', '/diannaohuishou/', '/dianzihuishou/', '/jiajuhuishou/', '/bangongshebeihuishou/', '/shebeihuishou/', '/yaopinhuishou/', '/lipinhuishou/', '/shechipinhuishou/', '/jinyinhuishou/', '/jianzhufeiliaohs/', '/kucunjiya/', '/dianchihuishou/', '/suliaohuishou/', '/bolihuishou/', '/feizhihuishou/', '/fangzhipigehs/', '/feixiangjiaohs/', '/fuzhuangyimaohs/', '/shoujihs/', '/xiaofeiquanhuishou/', '/yanjiuhuishou/', '/gouwukahuishou/', '/yishupinhuishou/', '/wentiyongpinhuishou/', '/qitahuishou/', '/binzang/', '/mudi/', '/bzypfw/', '/shoujishumaweixiu/', '/iphoneweixiu/', '/sanxingweixiu/', '/huaweiweixiu/', '/xiaomiweixiu/', '/meizuweixiu/', '/vivoweixiu/', '/oppoweixiu/', '/nubiyaweixiu/', '/chuiziweixiu/', '/leshiweixiu/', '/yijiaweixiu/', '/nuojiyaweixiu/', '/motuoluolaweixiu/', '/suoniweixiu/', '/xiapuweixiu/', '/lgweixiu/', '/duopudaweixiu/', '/lianxiangweixiu/', '/htcweixiu/', '/heimeiweixiu/', '/zhongxingweixiu/', '/kupaiweixiu/', '/tianyuweixiu/', '/jinliweixiu/', '/qitaweixiu/', '/lajiqingyun/', '/shenghuolaji/', '/jianzulaji/', '/gongyelaji/', '/zhuangxiulaji/', '/muyingqinzi/', '/qinzihuodong/', '/qinzihuisuo/', '/youerkexue/', '/ertongyiyuan/', '/yingerlifa/', '/ertongleyuan/', '/yingeryouyong/', '/baobaopaidui/', '/jianzuweixiu/', '/dajing/', '/kantan/', '/qiqiangchaichu/', '/jichuguanjiang/', '/gangtingdajian/', '/tongfengcaiguang/', '/fawujiagu/', '/pingfangjiagai/', '/huanqianghuanding/', '/jiatingzhuangxiu/', '/jiazhuangsheji/', '/qiangdifangchao/', '/shineishejifuwu/', '/chuweigaizao/', '/jiufangfanxin/', '/ruanzhuangsheji/', '/shigongjianli/', '/zhuangxiugongsi/', '/zhuangxiudui/', '/fangwuweixiu/', '/menchuangweixiu/', '/shuidiananzhuang/', '/dianluweixiu/', '/fangshui/', '/dinuan/', '/dengjuweixiu/', '/weiyuweixiu/', '/dakong/', '/fenshua/', '/dixiajiacenggelouanzhuang/', '/chaijiufuwu/', '/qitashenghuo/', 'http://m.liebiao.com/liupanshui/shenghuo/', '/jiazheng/', '/baojie/', '/banjia/', '/peisong/', '/jiadianweixiu/', '/diannaoweixiu/', '/shumaweixiu/', '/jiajuweixiu/', '/kaisuo/', '/zhuangxiu/', '/guandao/', '/lvyou/', '/dujiayou/', '/jiudianyuding/', '/canyin/', '/yundongjianshen/', '/xiuxianyule/', '/huwai/', '/yiliao/', '/meirong/', '/hunqingyili/', '/xianhualvzhi/', '/sheying/', '/yanglaoyuan/', '/ganxi/', '/jiuhuo/', '/binzang/', '/qitashenghuo/', '/shoujishumaweixiu/', '/lajiqingyun/', '/muyingqinzi/', '/jianzuweixiu/', '/jiatingzhuangxiu/', '/fangwuweixiu/', 'http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=46010602000129', 'http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=46010602000129']
NTRIES = 5

def hash_url():
    S1Spider.count += 1
    return S1Spider.count

f = open(LINKS_DIST, "w")
class S1Spider(scrapy.Spider):
    name = 's1'
    allowed_domains = []
    start_urls = ['http://anshun.liebiao.com/jinrongdaikuan/']
    count = 0
    rules = [
        Rule(
            LinkExtractor(
                canonicalize=True,
                unique=True
            ),
            follow=True,
            callback="parse"
        )
    ]

    custom_settings = {
        'DEPTH_LIMIT': 100,
        # 'DOWNLOADER_MIDDLEWARES' : {
        #         'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware': None,
        #         'scrapy_fake_useragent.middleware.RandomUserAgentMiddleware': 400,
        #     }
        'DNS_TIMEOUT': 720,
        'DOWNLOAD_TIMEOUT': 720
    }


    def start_requests(self):
        self.prov_links = ['http://beijing.liebiao.com/', 'http://beijing.liebiao.com/', 'http://shanghai.liebiao.com/', 'http://guangzhou.liebiao.com/', 'http://shenzhen.liebiao.com/', 'http://hangzhou.liebiao.com/', 'http://chengdu.liebiao.com/', 'http://tianjin.liebiao.com/', 'http://nanjing.liebiao.com/', 'http://anshan.liebiao.com/', 'http://anyang.liebiao.com/', 'http://anshun.liebiao.com/', 'http://anqing.liebiao.com/', 'http://ankang.liebiao.com/', 'http://ali.liebiao.com/', 'http://aletai.liebiao.com/', 'http://alashan.liebiao.com/', 'http://alaer.liebiao.com/', 'http://akesu.liebiao.com/', 'http://aba.liebiao.com/', 'http://beijing.liebiao.com/', 'http://baoding.liebiao.com/', 'http://baotou.liebiao.com/', 'http://binzhou.liebiao.com/', 'http://baicheng.liebiao.com/', 'http://bengbu.liebiao.com/', 'http://benxi.liebiao.com/', 'http://bijie.liebiao.com/', 'http://boertala.liebiao.com/', 'http://beihai.liebiao.com/', 'http://bazhong.liebiao.com/', 'http://bayinguoleng.liebiao.com/', 'http://bayannaoer.liebiao.com/', 'http://baoshan.liebiao.com/', 'http://baoji.liebiao.com/', 'http://baiyin.liebiao.com/', 'http://baishan.liebiao.com/', 'http://baise.liebiao.com/', 'http://bozhou.liebiao.com/', 'http://baisha.liebiao.com/', 'http://baoting.liebiao.com/', 'http://chongqing.liebiao.com/', 'http://chengdu.liebiao.com/', 'http://changchun.liebiao.com/', 'http://changsha.liebiao.com/', 'http://changzhou.liebiao.com/', 'http://cangzhou.liebiao.com/', 'http://changde.liebiao.com/', 'http://chuxiong.liebiao.com/', 'http://chongzuo.liebiao.com/', 'http://changdu.liebiao.com/', 'http://chaozhou.liebiao.com/', 'http://chenzhou.liebiao.com/', 'http://chizhou.liebiao.com/', 'http://chaohu.liebiao.com/', 'http://chuzhou.liebiao.com/', 'http://chaoyang.liebiao.com/', 'http://chifeng.liebiao.com/', 'http://changzhi.liebiao.com/', 'http://chengde.liebiao.com/', 'http://changji.liebiao.com/', 'http://changjiang.liebiao.com/', 'http://chengmai.liebiao.com/', 'http://dalian.liebiao.com/', 'http://daqing.liebiao.com/', 'http://dongguan.liebiao.com/', 'http://dongying.liebiao.com/', 'http://dezhou.liebiao.com/', 'http://diqing.liebiao.com/', 'http://dehong.liebiao.com/', 'http://dali.liebiao.com/', 'http://dazhou.liebiao.com/', 'http://deyang.liebiao.com/', 'http://datong.liebiao.com/', 'http://daxinganling.liebiao.com/', 'http://dandong.liebiao.com/', 'http://dingxi.liebiao.com/', 'http://danzhou.liebiao.com/', 'http://dongfang.liebiao.com/', 'http://dingan.liebiao.com/', 'http://eerduosi.liebiao.com/', 'http://enshi.liebiao.com/', 'http://ezhou.liebiao.com/', 'http://fuzhou.liebiao.com/', 'http://foshan.liebiao.com/', 'http://fangchenggang.liebiao.com/', 'http://fushun.liebiao.com/', 'http://fuxin.liebiao.com/', 'http://fuyang.liebiao.com/', 'http://fz.liebiao.com/', 'http://guangzhou.liebiao.com/', 'http://guiyang.liebiao.com/', 'http://guilin.liebiao.com/', 'http://guoluo.liebiao.com/', 'http://guigang.liebiao.com/', 'http://gannan.liebiao.com/', 'http://guangyuan.liebiao.com/', 'http://guangan.liebiao.com/', 'http://ganzi.liebiao.com/', 'http://ganzhou.liebiao.com/', 'http://guyuan.liebiao.com/', 'http://hangzhou.liebiao.com/', 'http://haerbin.liebiao.com/', 'http://hefei.liebiao.com/', 'http://haikou.liebiao.com/', 'http://handan.liebiao.com/', 'http://huizhou.liebiao.com/', 'http://huhehaote.liebiao.com/', 'http://huzhou.liebiao.com/', 'http://hengyang.liebiao.com/', 'http://huaian.liebiao.com/', 'http://hengshui.liebiao.com/', 'http://hezhou.liebiao.com/', 'http://heyuan.liebiao.com/', 'http://hechi.liebiao.com/', 'http://honghe.liebiao.com/', 'http://hanzhong.liebiao.com/', 'http://haidong.liebiao.com/', 'http://haibei.liebiao.com/', 'http://huangnan.liebiao.com/', 'http://hami.liebiao.com/', 'http://haixi.liebiao.com/', 'http://huaihua.liebiao.com/', 'http://hulunbeier.liebiao.com/', 'http://huludao.liebiao.com/', 'http://hegang.liebiao.com/', 'http://heihe.liebiao.com/', 'http://huainan.liebiao.com/', 'http://huaibei.liebiao.com/', 'http://huangshan.liebiao.com/', 'http://heze.liebiao.com/', 'http://hebi.liebiao.com/', 'http://huangshi.liebiao.com/', 'http://huanggang.liebiao.com/', 'http://hetian.liebiao.com/', 'http://jinan.liebiao.com/', 'http://jining.liebiao.com/', 'http://jiaxing.liebiao.com/', 'http://jinhua.liebiao.com/', 'http://jiangmen.liebiao.com/', 'http://jilin.liebiao.com/', 'http://jieyang.liebiao.com/', 'http://jinchang.liebiao.com/', 'http://jingzhou.liebiao.com/', 'http://jingmen.liebiao.com/', 'http://jiyuan.liebiao.com/', 'http://jiaozuo.liebiao.com/', 'http://jiayuguan.liebiao.com/', 'http://jincheng.liebiao.com/', 'http://jian.liebiao.com/', 'http://jiujiang.liebiao.com/', 'http://jingdezhen.liebiao.com/', 'http://jiamusi.liebiao.com/', 'http://jixi.liebiao.com/', 'http://jinzhou.liebiao.com/', 'http://jinzhong.liebiao.com/', 'http://jiuquan.liebiao.com/', 'http://kunming.liebiao.com/', 'http://kaifeng.liebiao.com/', 'http://kashi.liebiao.com/', 'http://kelamayi.liebiao.com/', 'http://kezilesu.liebiao.com/', 'http://lanzhou.liebiao.com/', 'http://lasa.liebiao.com/', 'http://linyi.liebiao.com/', 'http://luoyang.liebiao.com/', 'http://langfang.liebiao.com/', 'http://liaocheng.liebiao.com/', 'http://luzhou.liebiao.com/', 'http://leshan.liebiao.com/', 'http://liangshan.liebiao.com/', 'http://liupanshui.liebiao.com/', 'http://lijiang.liebiao.com/', 'http://lincang.liebiao.com/', 'http://linzhi.liebiao.com/', 'http://longnan.liebiao.com/', 'http://laibin.liebiao.com/', 'http://liuzhou.liebiao.com/', 'http://loudi.liebiao.com/', 'http://linfen.liebiao.com/', 'http://lvliang.liebiao.com/', 'http://liaoyang.liebiao.com/', 'http://liaoyuan.liebiao.com/', 'http://lianyungang.liebiao.com/', 'http://lishui.liebiao.com/', 'http://luan.liebiao.com/', 'http://longyan.liebiao.com/', 'http://laiwu.liebiao.com/', 'http://luohe.liebiao.com/', 'http://linxia.liebiao.com/', 'http://ledong.liebiao.com/', 'http://lingao.liebiao.com/', 'http://lingshui.liebiao.com/', 'http://maoming.liebiao.com/', 'http://mianyang.liebiao.com/', 'http://maanshan.liebiao.com/', 'http://meishan.liebiao.com/', 'http://meizhou.liebiao.com/', 'http://mudanjiang.liebiao.com/', 'http://nanjing.liebiao.com/', 'http://nanning.liebiao.com/', 'http://ningbo.liebiao.com/', 'http://nantong.liebiao.com/', 'http://nanyang.liebiao.com/', 'http://nanchang.liebiao.com/', 'http://nanping.liebiao.com/', 'http://naqu.liebiao.com/', 'http://neijiang.liebiao.com/', 'http://nanchong.liebiao.com/', 'http://ningde.liebiao.com/', 'http://nujiang.liebiao.com/', 'http://pingdingshan.liebiao.com/', 'http://panjin.liebiao.com/', 'http://panzhihua.liebiao.com/', 'http://pingliang.liebiao.com/', 'http://pingxiang.liebiao.com/', 'http://puer.liebiao.com/', 'http://putian.liebiao.com/', 'http://puyang.liebiao.com/', 'http://qingdao.liebiao.com/', 'http://quanzhou.liebiao.com/', 'http://qinhuangdao.liebiao.com/', 'http://qujing.liebiao.com/', 'http://qitaihe.liebiao.com/', 'http://qiqihaer.liebiao.com/', 'http://qionghai.liebiao.com/', 'http://qinzhou.liebiao.com/', 'http://qiandongnan.liebiao.com/', 'http://qingyuan.liebiao.com/', 'http://qingyang.liebiao.com/', 'http://qianxinan.liebiao.com/', 'http://qiannan.liebiao.com/', 'http://qianjiang.liebiao.com/', 'http://quzhou.liebiao.com/', 'http://qiongzhong.liebiao.com/', 'http://rikaze.liebiao.com/', 'http://rizhao.liebiao.com/', 'http://shanghai.liebiao.com/', 'http://suzhou.liebiao.com/', 'http://shenyang.liebiao.com/', 'http://shijiazhuang.liebiao.com/', 'http://shenzhen.liebiao.com/', 'http://shaoxing.liebiao.com/', 'http://shantou.liebiao.com/', 'http://shangqiu.liebiao.com/', 'http://suihua.liebiao.com/', 'http://shaoguan.liebiao.com/', 'http://siping.liebiao.com/', 'http://shuozhou.liebiao.com/', 'http://shanwei.liebiao.com/', 'http://sanya.liebiao.com/', 'http://suining.liebiao.com/', 'http://shannan.liebiao.com/', 'http://shangluo.liebiao.com/', 'http://shizuishan.liebiao.com/', 'http://shaoyang.liebiao.com/', 'http://shennongjia.liebiao.com/', 'http://suqian.liebiao.com/', 'http://shuangyashan.liebiao.com/', 'http://suzh.liebiao.com/', 'http://sanming.liebiao.com/', 'http://shangrao.liebiao.com/', 'http://sanmenxia.liebiao.com/', 'http://songyuan.liebiao.com/', 'http://shiyan.liebiao.com/', 'http://suizhou.liebiao.com/', 'http://shihezi.liebiao.com/', 'http://sansha.liebiao.com/', 'http://tianjin.liebiao.com/', 'http://taiyuan.liebiao.com/', 'http://tangshan.liebiao.com/', 'http://taizhou.liebiao.com/', 'http://taian.liebiao.com/', 'http://taizh.liebiao.com/', 'http://tongling.liebiao.com/', 'http://tongren.liebiao.com/', 'http://tulufan.liebiao.com/', 'http://tacheng.liebiao.com/', 'http://tongliao.liebiao.com/', 'http://tonghua.liebiao.com/', 'http://tongchuan.liebiao.com/', 'http://tieling.liebiao.com/', 'http://tianshui.liebiao.com/', 'http://tianmen.liebiao.com/', 'http://tumushuke.liebiao.com/', 'http://tunchang.liebiao.com/', 'http://wuhan.liebiao.com/', 'http://wulumuqi.liebiao.com/', 'http://wenzhou.liebiao.com/', 'http://wuxi.liebiao.com/', 'http://weihai.liebiao.com/', 'http://weifang.liebiao.com/', 'http://wulanchabu.liebiao.com/', 'http://wuwei.liebiao.com/', 'http://wuzhong.liebiao.com/', 'http://wujiaqu.liebiao.com/', 'http://wuhu.liebiao.com/', 'http://wanning.liebiao.com/', 'http://wuhai.liebiao.com/', 'http://wenshan.liebiao.com/', 'http://wenchang.liebiao.com/', 'http://weinan.liebiao.com/', 'http://wuzhou.liebiao.com/', 'http://wuzhishan.liebiao.com/', 'http://xian.liebiao.com/', 'http://xiamen.liebiao.com/', 'http://xuzhou.liebiao.com/', 'http://xingtai.liebiao.com/', 'http://xiangfan.liebiao.com/', 'http://xuchang.liebiao.com/', 'http://xinxiang.liebiao.com/', 'http://xishuangbanna.liebiao.com/', 'http://xiangxi.liebiao.com/', 'http://xianyang.liebiao.com/', 'http://xiangtan.liebiao.com/', 'http://xiantao.liebiao.com/', 'http://xianning.liebiao.com/', 'http://xiaogan.liebiao.com/', 'http://xinyang.liebiao.com/', 'http://xinyu.liebiao.com/', 'http://xuancheng.liebiao.com/', 'http://xilinguole.liebiao.com/', 'http://xingan.liebiao.com/', 'http://xinzhou.liebiao.com/', 'http://xining.liebiao.com/', 'http://yinchuan.liebiao.com/', 'http://yantai.liebiao.com/', 'http://yancheng.liebiao.com/', 'http://yangzhou.liebiao.com/', 'http://yueyang.liebiao.com/', 'http://yichang.liebiao.com/', 'http://yangquan.liebiao.com/', 'http://yulin.liebiao.com/', 'http://yibin.liebiao.com/', 'http://yaan.liebiao.com/', 'http://yuxi.liebiao.com/', 'http://yanan.liebiao.com/', 'http://yul.liebiao.com/', 'http://yushu.liebiao.com/', 'http://yunfu.liebiao.com/', 'http://yangjiang.liebiao.com/', 'http://yuncheng.liebiao.com/', 'http://yingkou.liebiao.com/', 'http://yanbian.liebiao.com/', 'http://yichun.liebiao.com/', 'http://yingtan.liebiao.com/', 'http://yich.liebiao.com/', 'http://yiyang.liebiao.com/', 'http://yongzhou.liebiao.com/', 'http://yili.liebiao.com/', 'http://yangpu.liebiao.com/', 'http://zhengzhou.liebiao.com/', 'http://zhuhai.liebiao.com/', 'http://zibo.liebiao.com/', 'http://zhenjiang.liebiao.com/', 'http://zhangzhou.liebiao.com/', 'http://zhongshan.liebiao.com/', 'http://zhanjiang.liebiao.com/', 'http://zhaoqing.liebiao.com/', 'http://zhoukou.liebiao.com/', 'http://zaozhuang.liebiao.com/', 'http://zhumadian.liebiao.com/', 'http://zunyi.liebiao.com/', 'http://zhaotong.liebiao.com/', 'http://zhangjiakou.liebiao.com/', 'http://zhangye.liebiao.com/', 'http://ziyang.liebiao.com/', 'http://zigong.liebiao.com/', 'http://zhangjiajie.liebiao.com/', 'http://zhuzhou.liebiao.com/', 'http://zhoushan.liebiao.com/', 'http://zhongwei.liebiao.com/']
        l = []
        for i in range(NTRIES):
            l.append(choice(self.prov_links)[:-1] + choice(INDS))
        self.start_urls = l
        for url in self.start_urls:
            yield scrapy.Request(url, callback=self.parse, dont_filter=True)

    def parse(self, response):
        links = LinkExtractor(canonicalize=True, unique=True).extract_links(response)
        links = response.xpath("//a/@href").extract()
        links = [item for item in links if re.search(r'http://[a-z]+\.liebiao\.com/[a-z]+/\d+.html$', item) is not None]
        for item in links:
            f.write("%s\n" % item)
        for link in links:
            yield response.follow(link, self.parse)

    def get_prov_names(self):
        prov_c = get("http://www.liebiao.com/", timeout=60).content
        soup = BeautifulSoup(prov_c)
        links = soup.find_all("a")
        
        self.prov_links = [link.get("href") for link in links if re.search(PROVINCE_RE, link.get("href")) is not None]
        return self.prov_links
    
    def get_industries(self):
        industries = ['peixun/', 'shangwu/', 'shenghuo/']
        links = []
        for industry in industries:
            inds_c = get(choice(self.prov_links) + industry).content
            soup = BeautifulSoup(inds_c)
            suff = soup.find_all("a")
            links.extend([suffix.get('href') for suffix in suff if re.search(r'\/[a-z]+\/', suffix.get('href')) is not None])
        return links  

print(LINKS_DIST)
